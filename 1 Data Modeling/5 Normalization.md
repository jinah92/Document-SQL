# 데이터 모델과 성능 - 정규화, 반정규화



## 정규화 (Normalization)

### 1. 정규화

---

- 데이터의 일관성, 최소한의 데이터 중복, 최대한의 데이터 유연성을 확보
- 데이터를 분해하는 과정
- 비즈니스에 변화가 발생해도 데이터 모델의 변경을 최소화할 수 있음
- 제 1~5 정규화가 존재

### (정규화 절차)

1. 제 1정규화 **(도메인)**
    - 속성의 원자성을 확보
    - 기본키 설정
2. 제 2정규화 **(부분 함수 종속성)**
    - 기본키가 2개 이상의 속성으로 이루어진 경우
    ⇒ 부분 함수 종속성을 제거
3. 제 3정규화 **(이행 함수 종속성)**
    - 기본키를 제외한 컬럼 간의 종속성을 제거
    - 이행 함수 종속성 제거
4. BCNF **(결정자를 제외한 후보키 분해)**
    - 기본키를 제외한 후보키 존재 ⇒ 후보키가 기본키를 종속시키면 분해
5. 제 4정규화 **(다중 속성값)**
    - 여러 칼럼들이 하나의 컬럼을 종속 ⇒ 다중속성값 제거
6. 제 5정규화 **(조인 종속성)**
    - 조인에 의한 종속성 발생 시 분해

### 2. 정규화와 성능

---

- 테이블 분해, 데이터 중복을 제거 ⇒ 데이터 모델의 유연성 높임
- 데이터 조회(SELECT) 시 조인(JOIN) 발생 ⇒ CPU와 메모리를 많이 소모

**반정규화**
: 정규화로 인해 발생되는 성능 저하를 해결하는 방법
: 데이터를 중복시켜 저장하므로, 또 다른 문제가 발생 가능
(디스크 I/O 증가로 인한 성능 저하)

### 3. 반정규화

---

- 데이터 중복 허용 및 조인(JOIN) 감소를 통한 데이터베이스 성능 향상
- 조회(SELECT) 속도는 증가하나, 데이터 모델의 유연성은 낮아짐

반정규화를 수행하는 경우
- 정규화에 따라 수행 속도가 느려지는 경우
- 다량의 범위를 자주 처리하는 경우
- 특정 범위의 데이터만 자주 처리하는 경우
- 요약/집계 정보가 자주 요구되는 경우

- 반정규화 절차
    1. 대상 조사 및 검토 (데이터 처리 범위, 통계성 등을 확인)
    2. 다른 방법 검토 (클러스터링, 뷰, 인덱스 튜닝, 응용 프로그램, 파티션)
    3. 반정규화 수행 (테이블, 속성, 관계 등을 반정규화)

    클러스터링(Clustering)
    - 인덱스 정보를 저장할 때 물리적으로 정렬해서 저장하는 방법
    - 조회 시에 인접 블록을 연속적으로 읽음

- 반정규화 절차
    1. 계산된 컬럼 추가 (총판매액, 평균잔고, 계좌평가 등)
    2. 테이블 수직분할 (칼럼 기준으로 분할하여 새로운 테이블을 생성)
    3. 테이블 수평분할 (값을 기준으로 테이블을 분할)
    4. 테이블 병합 (1 대 1 관계의 테이블을 하나로 병합)
        - 슈퍼 타입과 서브 타입 관계 ⇒ 테이블 통합
        (ex) 고객 - 슈퍼 타입 / 개인고객, 법인고객 - 서브 타입

    파티션 테이블
    (정의) 논리적으로는 하나의 테이블이지만 여러 개의 데이터 파일에 분산되어 저장됨
     - Range Partition : 데이터값의 범위 기준
     - List Partition : 특정 값을 지정
     - Hash Partition : 해시함수 적용
     - Composite Partition : 범위와 해시를 복합적으로 사용

    (장점)
     - 조회 시 액세스 범위가 줄어듬 ⇒ 성능 향상
     - 데이터의 분할 ⇒ I/O의 성능 향상
     - 각 파티션을 독립적으로 백업 및 복구

---